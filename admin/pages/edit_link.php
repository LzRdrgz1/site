<?php
if (!defined("JUICYCODES")) {
    exit;
}
$html->active("manage_links")->SetTitle("Edit Links");
require_once ADMINPATH . "/header.php";
$links = $db->select("files", "*", array("id" => $var->get->id));
if ($links->num_rows != "1") {
    $html->error("Invalid Link Selected!")->Redirect($html->Url("manage/links"), true);
}
$link = $links->fetch_object();
$subtitle = IT\JuicyCodes::Decode($link->subtitle, "stfu_ovi");
if (IT\JuicyCodes::isSubtitle($subtitle)) {
    $subtitles = explode(",", $subtitle);
    foreach ($subtitles as $subtitle) {
        $sub_av = true;
        $sub[] = "<span class=\"label label-success sub\" data-sub=\"" . $subtitle . "\">" . $subtitle . " <i class=\"fa fa-times\"></i></span>";
    }
}
$html->element("div", array("class" => "panel"), array($html->element("div", array("class" => "panel-heading"), array($html->element("h3", array("class" => "panel-title"), array("EDIT LINK")), $html->element("div", array("class" => "right"), array($html->element("a", array("class" => "btn btn-primary btn-sm", "href" => $html->url("manage/links")), array("Manage Links")))))), $html->element("form", array("method" => "post", "action" => $html->url("actions"), "enctype" => "multipart/form-data"), array($html->input("hidden", "hide", false, "action", "edit_link"), $html->input("hidden", "hide", false, "id", $var->get->id), $html->element("div", array("class" => "panel-body"), array($html->element("div", array("class" => "row"), array($html->element("div", array("class" => "col-lg-4 col-md-6"), array($html->element("div", array("class" => "form-group"), array($html->label("jc_title", "control-label", "Link Title"), $html->tip("Insert Title For This Video"), $html->input("text", "form-control", "jc_title", "jc_title", $link->title, "Insert Title For This Video"))), $html->element("div", array("class" => "form-group"), array($html->label("jc_link", "control-label", "Video Link"), $html->tip("Insert Link For This Video"), $html->input("url", "form-control", "jc_link", "jc_link", IT\JuicyCodes::Link(IT\JuicyCodes::Decode($link->link, "stfu_ovi"), $link->source)))), $html->element("div", array("class" => "form-group"), array($html->label("jc_embed", "control-label", "Alt Embed Link"), $html->tip("IInsert An Alternate Embed Link For This Video"), $html->input("url", "form-control", "jc_embed", "jc_embed", $link->embed, "Insert An Alternate Embed Link For This Video"))), $html->element("div", array("class" => "form-group"), array($html->label("jc_preview", "control-label", "Custom Preview"), $html->tip("Insert Custom Preview URL For This Video"), $html->element("span", array("class" => "pull-right"), array($html->element("span", array("class" => "label label-info cp", "id" => "pre"), array($html->element("i", array("class" => "fa fa-cloud-upload")))))), $html->input("url", "form-control", "jc_preview", "jc_preview", IT\JuicyCodes::Decode($link->preview, "stfu_ovi"), "Insert Custom Preview URL"))), $html->element("div", array("class" => "form-group"), array($html->label("remove_sub", "control-label", "Existing Subtitles"), $html->tip("Existing Subtitles"), $html->input("hidden", "hide", "remove_sub", "remove_sub"), $html->element("div", array("class" => "subtitle"), array(implode(" ", $sub)))), false, array(array(IT\JuicyCodes::isSubtitle($subtitle)))))))), $html->element("div", array("class" => "row"), array($html->element("div", array("class" => "col-lg-2 col-md-3"), array($html->element("div", array("class" => "form-group", "id" => "sub_files"), array($html->label(false, "control-label", "Subtitle File"), $html->tip("Select Subtitle File For This Video"), $html->input("file", "form-control sub_file m-b-xs", false, "subtitle[]"))))), $html->element("div", array("class" => "col-lg-2 col-md-3"), array($html->element("div", array("class" => "form-group", "id" => "sub_labels"), array($html->label(false, "control-label", "Subtitle Label"), $html->tip("Insert Subtitle Language For This Video"), $html->element("span", array("class" => "pull-right"), array($html->element("span", array("class" => "label label-info cp", "id" => "add_sub"), array($html->element("i", array("class" => "fa fa-plus")))))), $html->input("text", "form-control sub_label m-b-xs", false, "subtitle_label[]"))))))), $html->element("div", array("class" => "row"), array($html->element("div", array("class" => "col-lg-2 col-md-3"), array($html->element("div", array("class" => "form-group"), array($html->label("jc_slug", "control-label", "Custom Slug"), $html->tip("Insert Custom Slug For This Video"), $html->input("text", "form-control", "jc_slug", "jc_slug", $link->slug))))), $html->element("div", array("class" => "col-lg-2 col-md-3"), array($html->element("div", array("class" => "form-group"), array($html->label("jc_type", "control-label", "Generation Type"), $html->tip("Insert Title For This Video"), $html->element("select", array("class" => "form-control", "id" => "jc_type", "name" => "jc_type"), array($html->option("Player + Download", "3", $link->type), $html->option("Only Player", "1", $link->type), $html->option("Only Download", "2", $link->type))))))))))), $html->element("div", array("class" => "panel-footer"), array($html->element("button", array("type" => "submit", "class" => "btn btn-info"), array("EDIT LINK"))))))), true);
$html->script("\r\n    \$(\"#pre\").click(function(){\r\n        var icon = \$(this).find(\"i\");\r\n        \$(\"#jc_preview\").fadeOut(\"fast\");\r\n        if(icon.hasClass(\"fa-cloud-upload\")){\r\n            \$(this).fadeOut(\"fast\",function(){\r\n                icon.removeClass(\"fa-cloud-upload\").addClass(\"fa-chain\");\r\n                \$(\"#jc_preview\").prop(\"type\",\"file\").fadeIn(\"fast\");\r\n                \$(this).fadeIn(\"fast\");\r\n            });\r\n        } else{\r\n            \$(this).fadeOut(\"fast\",function(){\r\n                icon.removeClass(\"fa-chain\").addClass(\"fa-cloud-upload\");\r\n                \$(\"#jc_preview\").prop(\"type\",\"url\").fadeIn(\"fast\");\r\n                \$(this).fadeIn(\"fast\");\r\n            });\r\n        }\r\n    });\r\n    \$(\"#add_sub\").click(function(){\r\n        \$(\$(\".sub_file\").eq(0).clone().val(\"\")).appendTo(\$(\"#sub_files\")).slideDown(\"fast\");\r\n        \$(\$(\".sub_label\").eq(0).clone().val(\"\")).appendTo(\$(\"#sub_labels\")).slideDown(\"fast\");\r\n    });\r\n    \$(\".sub i\").click(function(){\r\n        \$(this).parent().fadeOut();\r\n        var val=\$(\"#remove_sub\").val();\r\n        \$(\"#remove_sub\").val(val+\",\"+\$(this).parent().data(\"sub\"));\r\n    });\r\n");
require_once ADMINPATH . "/footer.php";